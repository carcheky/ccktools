#!/bin/bash

# CUSTOM CONFIGS
PROMPT='${ret_status} %{$fg[cyan]%}%3~$reset_color%3} $(git_prompt_info)'


# LOAD SOURCES
if [[ -d "$HOME/bin" ]]; then
    export PATH="$HOME/bin:$PATH"
fi

if [[ -d "$HOME/.config/composer/vendor/bin" ]]; then
    export PATH="$HOME/.config/composer/vendor/bin:$PATH"
fi


# INCLUDE DRUSH BASH CUSTOMIZATIONS.
if [ -f "$HOME/.drush/drush.bashrc" ] ; then
  source $HOME/.drush/drush.bashrc
fi

source $HOME/ccktools/.ccktools_aliases
source $HOME/ccktools/.ccktools_functions


# FUNCTIONS
ssh_laucher(){
  SERVICE="ssh-agent"
  if pgrep -x "$SERVICE"
  then
      echo "$SERVICE is running yet"
  else
      echo "starting $SERVICE"
      sudo chmod 700 $HOME/.ssh
      sudo chmod 600  $HOME/.ssh/*
      sudo chmod 600 $HOME/.ssh/*.pub
      eval `ssh-agent -s`
      ssh-add -q $HOME/.ssh/id_rsa_c*

  fi
}

lamp_laucher(){
  SERVICE="apache2"
  if pgrep -x "$SERVICE"
  then
      echo "$SERVICE is running yet"
  else
      echo "starting $SERVICE"
      lamp start
  fi
}

# LOGIC

echo "=> loading ssh..."
ssh_laucher &>/dev/null
echo "=> loading lamp..."
lamp_laucher &>/dev/null

gosi
if [ -f "$HOME/ccktools/.ccktools_custom" ]; then
  source $HOME/ccktools/.ccktools_custom
fi
